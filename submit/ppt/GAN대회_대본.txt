#1
안녕하세요 이번 딥러닝 ai 대회에 참여하게 된 백지윤, 송승원, 신해나라입니다. 저희는 팀 이름을 무소속이라고 지었는데요 , 이는 이어서 간단한 저희 소개를 들으시면 재밌게 와닿으실 수 있을 것 같습니다.

#2
우선 팀원 소개를 간단히 하고 저희 프로젝트 목표가 무엇이었는지, 어떻게 진행되어서 어떠한 결과가 나왔는지 결론까지를 이어서 설명하겠습니다.

#3
저희 팀원이 무소속인 이유는 스타트업 pm으로 근무하던 승원님의 경우 현재 퇴사를 하고 데이터 분석을 주도적으로 공부하고 계셨고, 나라님의 경우도 재료공학 박사 과정 중 전공을 바꾸어 딥러닝을 공부하고 계셨으며 저 또한 현재는 대학원생 신분이 되었지만 대회 참여 당시 아무 소속 없이 신기하고 어려운 딥러닝 공부에 흥미를 갖고 혼자 공부하고 있는 무소속 상태였기 때문입니다. 이처럼 저희는 딥러닝에 대한 열정 하나만을 가지고 각자 생활하다가 이번 프로젝트에 흥미를 갖고 그것이 연이 되어 모인 사람들입니다.

#4
따라서 이번 프로젝트를 통해 엄청난 연구를 성공한다기 보가는 초보자 수준에서 gan 생성 모델에 대한 이해를 높이고 아직은 진행되지 않은 해당 프로젝트를 통해 개인적으로 필요한 결과물을 얻으며 경험을 쌓고 싶었습니다. 따라서 본 발표에 저희가 공부하면서 정리한 개념들과 실제 결과물을 간단하게 녹여내보고자 합니다.

#5
그래서 저희는 향후 발전된 gan 모델의 핵심이 되는 basic gan 모델에 대해 알아보고 각자의 방식으로 task 에 도전하여 제일 좋은 성능을 내는 모델을 선택하였습니다. 

#6
우선 다들 잘 아시겠지만 vanilla gan 모델의 경우 원본 이미지의 확률 분포를 학습함으로써 최대한 원본 이미지에 비슷한 가짜 이미지를 출력하도록 하는 생성 모델입니다.

#7
해당 vanilla gan 에선 두 가지 모델 discriminator, generator 가 학습을 연차적으로 진행하는데 진짜 이미지일 확률이 몇 퍼센트인지를 출력하는 discriminator의 경우는 본 수식에 따라서 maximum 이 되도록 최적화가 진행됩니다.

#8
뒤따라서 generator 의 경우는 discriminator을 최대한 잘 속이도록 하여 위 수식이 minimum이 되도록 최적화가 진행됩니다. 향후 나온 gan 모델들도 모두 이 loss function 에 근간을 두고 조금씩 수식을 추가한 형태입니다.

#9, #10, #11
Conditional gan 의 경우 기존 vanilla gan에 100만원의 , 50만원의 와 같은 ~의 라는 조건부 부분만 추가한 것입니다.

#12
비록 실패했지만 제가 저희의 task 에 적용해본 cycle gan의 경우 각기 다른 도메인에서 온 2개의 이미지를 서로의 도메인에 맞게 변환시켜주는 모델입니다

#13
그래서 두 도메인 각각에 discriminator,generator이 존재하고 향후 도메인 a의 generator을 통해 나온 이미지를 복원시켰을 때, 도메인 b의 generator을 통해 나온 이미지를 복원시켰을 때 loss가 최소화되도록 복원 loss를 추가하였습니다.

#14,15,16,17
Star gan의 경우는 도메인 a _ 셀럽 데이터, 도메인 b _ 얼굴 표정 데이터 등 다중 도메인에서 이미지 변환이 가능하도록 하는 단일 모델입니다. 저희도 style 자체를 변환시키는 방식을 사용하였으나 도메인은 하나만 필요했기 때문에 star gan 을 사용하진 않았습니다. 따라서 시간 관계상 해당 부분은 넘어가도록 하겠습니다.

#18
저희 프로젝트 task를 본격적으로 발표하겠습니다. 저희 집 강아지는 제가 초등학교 5학년 때 처음 가족의 연을 맺은 이후로 15년 째 저와 동거동락하고 있습니다. 그 중간 중간 화질이 안 좋은 폴더폰에서 부터 터치폰, 스마트폰으로 바꾸는 과정이 있었고 요즘은 유튜브로 추억을 잘 저장할 수가 있지만 제가 어릴 때만 하더라도 사람 앨범이 아닌 아기 때 강아지 성장과정을 잘 저장해 놓을 수 있는 방법이 많지 않았습니다. 반려인 분들은 아마 공감하실 수 있을 것 같은데 따라서 노견이 된 개의 강아지 시절 모습을 복원하는 해당 task는 반려인의 가족같은 강아지에 대한 애정어린 사랑에서 부터 시작되었다고 보시면 될 것 같습니다.

#19
저희 세 명은 각자 성견과 어린 강아지를 서로 다른 도메인으로 보고 도메인을 변환시키는 방식, 성견에서 조금씩 다른 스타일을 입혀서 어린 강아지 이미지로 재탄생시킨다고 보는 style change 방식, 기존 연구가 진행된 사람 face aging gan 을 차용한 방식 세 가지를 시도해보았습니다.

#20,21
우선 제가 시도한 domain change 의 경우는 성견 요크셔 도메인과 아기 요크셔 도메인 각각에서 고품질의 데이터가 필요하다는 한계가 있었습니다. 우선 가능성 여부부터 체크해보고자 각 웹 포탈 사이트로부터 자동 크롤링 코드를 통해 1000장 씩을 크롤링해서 에폭 5마다 값을 찍어보았습니다. 하지만 임시 테스트 결과물을 보며 변환 자체가 불가능하다는 결론을 내렸고 cycle gan은 이미지의 거시적 분위기나 배경을 바꾸는 것이 아닌 미세한 이미지 모양 등을 변화시키는 데에는 취약하다는 것을 알게 되었습니다. 또한 크롤링 된 이미지를 확인한 결과 성견과 아기 강아지의 위치 및 배경 등이 제각각이었고 얼굴 사진리 아닌 움직이는 사진도 많았습니다.

#22
나라님이 시도해보신 face aging gan 의 경우 conditional gan을 기반으로 사람 노화 이미지 생성 과제에 적용한 모델입니다. 이를 강아지에도 똑같이 활용할 수 있을까 확인하본 결과 우선 마찬가지로 전체적인 이미지 품질이 좋지 않았고 얼굴 형태를 복원하지 못했습니다. 사람 얼굴 데이터 셋 기반의 사전 학습 가중치가 동물에는 맞지 않다는 것을 알게 되었고 고품질 이미지를 얻기 위해 너무 많은 학습 시간이 필요한 무거운 모델이었기 때문에 저희 프로젝트와 같은 일반적 task에 바로 적용하기에는 무리가 있겠다라는 생각이 들었습니다

#23, 24
마지막으로 style 에 조금씩 변형을 주는 방식의 경우 여러 도메인이 아니라 성견 스타일에서 아기 강아지 스타일로의 도메인이 하나라는 점을 감안하였을 때 다양한 모델 중 최신 모델인 style gan2 ada를 사용해보았습니다. 해당 결과는 이런 식으로 나왔는데 완전히 task에 성공했다고 보기는 어려우나 세 가지 방식 중 제일 두드러지는 스타일 변화를 가져왔습니다. 

#25
스타일 갠은 기존 gan과는 다르게 vector space에서 latent vector z를 바로 뽑지 않고 z공간에 있을 털 색깔, 눈 크기 등 다양한 스타일들이 있는 이 공간을 linear 8개 층을 통해 풀어준 W 라는 벡터 공간에서 뽑힌 latent vector w를 z 대신 사용합니다. 이 w latent vector에서 affine transformation을 거쳐서 추출된 스타일들을 랜덤 상수에 점차 레이어를 쌓아가만서 입힘으로써 점점 스타일이 변화한 이미지가 생성됩니다.

#26
Style gan2 의 경우 style을 입히는 과정에서 정규화를 instance norm대신에 weight norm 응 사용했다는 점에서 조금씩 style transfer 성능을 더욱 더 향상시킨 업그레이드 버전으로 보시면 될 것 같습니다. Style gan2가 저희 주제에 제일 잘 맞은 이유를 분석해보았는데 우선 사실상 크롤링을 통해 데이터 자체를 구하기 불가능했던 데 비해 style gan2는 이미 pretrain 단계에서 개,고양이,야생동물 총 15000장으로 구성된 afhq 데이터를 사옹하였습니다. 여기에 ada 라는 데이터 증강 방식을 덧붙였기 때문에 저희가 원하는 강아지 이미지 특징이 확률 분포에 잘 반영되었음을 알 수 있습니다. 또한 앞서 설명드린대로 z를 w로 매핑함으로써 한 공간에 뭉쳐있는 스타일들을 단독으로 입힐 수 있었고 이 결과 강아지와 성견의 미묘하게 다른 스타일 변화를 이끌어낼 수 있었습니다.

#27
저희는 이쯤에서 프로젝트 목표를 되짚어보았습니다. 반려인의 아쉬움이 반려동물이 어렸을 때 많은 추억을 기록하지 못한 것이라면 최대한 저희 결과를 활용하여 과거 사진과 현재 사진을 갖고 그 사이의 시간글을 복원해주는 것이 더 의미가 있을 수 있겠다는 생각이 들었습니다.

#28
그래서 기존 afhq dog 데이터로 학습된 모델을 가져와서 W space 내에 존재하는 여러 latent vector 중 저희 모델에 맞는 latent vector을 가져오는 과정을 거쳤습니다. Sample 성견이미지 latent vector 에서 sample 아기 강아지 latent vector을 뺀 값을 age vector 로 두고 저희가 본격적으로 어린시절로 복원하고 싶은 타겟 성견이미지의 latent vector에 이 age vector 를 빼서 원하는 결과를 만들었습니다.
이 때 age vector 를 몇 퍼센트나 빼줄 것인지 그 비중을 점점 높여가서 성견이 아기 강아지로 변하는 모습을 gif 포맷으로 만들었습니다. 해당 부분은 코드 실습 과정에서 더 자세하게 설명하겠습니다.

#29
저희 결과입니다. 다양한 강아지들이 차례로 있는데 저는 이중 골든 리트리버로 실습을 진행하겠습니다.


#30
쿠키 영상 넘어가기. 저희 노견인 토리와 하루하루 소중하게 보내고 있던 저에게 좋은 추억을 선사해준 저희 팀원 분들께 다시 한번 감사드립니다. 해당 프로젝트는 눈 코 입 위치 등이 너무 다른 sample 과 target 이미지에는 정확히 적용되지 못하며 배경이 흰색이 아니라 약간 남아있는 경우 얼굴이 아닌 이 부분까지는 자연스럽게 적용할 수 없다는 한계가 있었습니다. 해당 한계를 조금씩 보완한다면 요즘 핫한 여러 이미지 변환 어플에도 적용되어서 반려인들에게 좋은 추억을 선사할 수 있지 않을까 싶습니다.

#31 
이제까지 발표를 들어주셔서 감사합니다. 이어서 바로 실습으로 넘어가겠습니다.